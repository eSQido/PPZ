#Tworzenie lokalizacji projektu
    $ProjectLocalisation="c:\AutoScriptResult"
    $DrivesLocalisation=$ProjectLocalisation+"\Drives"
    $VMLocalisation=$ProjectLocalisation+"\VM"
    $BasicDrives=$DrivesLocalisation+"\BasicDrives"
    New-Item -Path $ProjectLocalisation -ItemType Directory
    New-Item -Path $DrivesLocalisation -ItemType Directory
    New-Item -Path $BasicDrives -ItemType Directory
    New-Item -Path $VMLocalisation -ItemType Directory
#Tworzenie transkryptu projektu
    $scriptTranscript=$ProjectLocalisation+"\log"
    if(Test-Path -Path $scriptTranscript){
        Write-Host "Istnieje lokalizacja $scriptTranscript" -ForegroundColor Red
    }else{
        Write-Host "Utworzono folder do przechowywania danych $scriptTranscript" -ForegroundColor Green
    }
    Start-Transcript $scriptTranscript
#Przenoszenie dysk√≥w podstawowych z folderu skryptu do docelowej lokalizacji
    $scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
    $windowsServerBasicDriveInitPath=$scriptPath+"\windowsServerBasicDrive.vhdx"
    $windowsClientBasicDriveInitPath=$scriptPath+"\windowsClientBasicDrive.vhdx"
    Move-Item -Path $windowsServerBasicDriveInitPath -Destination $BasicDrives
    Move-Item -Path $windowsClientBasicDriveInitPath -Destination $BasicDrives
    $windowsServerBasicDrivePath=$BasicDrives+"\windowsServerBasicDrive.vhdx"
    $windowsClientBasicDrivePath=$BasicDrives+"\windowsClientBasicDrive.vhdx"
#Tworzenie maszyn wirtualnych
    $VMcount=3
    $VMname="VM"
    for($i=1;$i -le $VMcount;$i++){
        New-VHD -ParentPath $windowsClientBasicDrivePath -Path $DrivesLocalisation+"VM"+$i+"DiffDrive.vhdx" -Differencing
        new-vm -Name $VMname+$i -Path $VMLocalisation -VHDPath $DrivesLocalisation+"VM"+$i+"DiffDrive.vhdx"
    }
    New-VHD -ParentPath $windowsServerBasicDrivePath -Path $DrivesLocalisation+"ServerDiffDrive.vhdx" -Differencing
    new-vm -Name $VMname+"Server" -Path $VMLocalisation -VHDPath $DrivesLocalisation+"ServerDiffDrive.vhdx"
       
