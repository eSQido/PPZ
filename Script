#Tworzenie lokalizacji projektu
    $ProjectLocalisation="c:\AutoScriptResult"
    $DrivesLocalisation=$ProjectLocalisation+"\Drives"
    $VMLocalisation=$ProjectLocalisation+"\VM"
    $BasicDrives=$DrivesLocalisation+"\BasicDrives"
    New-Item -Path $ProjectLocalisation -ItemType Directory
    New-Item -Path $DrivesLocalisation -ItemType Directory
    New-Item -Path $BasicDrives -ItemType Directory
    New-Item -Path $VMLocalisation -ItemType Directory
#Tworzenie transkryptu projektu
    $scriptTranscript=$ProjectLocalisation+"\log"
    if(Test-Path -Path $scriptTranscript){
        Write-Host "Istnieje lokalizacja $scriptTranscript" -ForegroundColor Red
    }else{
        Write-Host "Utworzono folder do przechowywania danych $scriptTranscript" -ForegroundColor Green
    }
    Start-Transcript $scriptTranscript
#Przenoszenie dysk√≥w podstawowych z folderu skryptu do docelowej lokalizacji
    $scriptPath = split-path -parent $MyInvocation.MyCommand.Definition
    $windowsServerBasicDriveInitPath=$scriptPath+"\windowsServerBasicDrive.vhdx"
    $windowsClientBasicDriveInitPath=$scriptPath+"\windowsClientBasicDrive.vhdx"
    Move-Item -Path $windowsServerBasicDriveInitPath -Destination $BasicDrives
    Move-Item -Path $windowsClientBasicDriveInitPath -Destination $BasicDrives
    $windowsServerBasicDrivePath=$BasicDrives+"\windowsServerBasicDrive.vhdx"
    $windowsClientBasicDrivePath=$BasicDrives+"\windowsClientBasicDrive.vhdx"
#Tworzenie maszyn wirtualnych
    $VMcount=3
    $VMname="VM"
    for($i=1;$i -le $VMcount;$i++){
        New-VHD -ParentPath $windowsClientBasicDrivePath -Path ($DrivesLocalisation="\VM$iDiffDrive.vhdx") -Differencing
        new-vm -Name ($VMname+$i) -Path $VMLocalisation -VHDPath ($DrivesLocalisation+"\VM$iDiffDrive.vhdx")
    }
    New-VHD -ParentPath $windowsServerBasicDrivePath -Path ($DrivesLocalisation+"\ServerDiffDrive.vhdx") -Differencing
    new-vm -Name ($VMname+"Server") -Path $VMLocalisation -VHDPath ($DrivesLocalisation+"\ServerDiffDrive.vhdx")
#Konfiguracja serwera
    Start-VM -Name ($VMname+"Server")
    Enter-PSSession -VMName ($VMname+"Server")
    Rename-Computer -NewName ($VMname+"Server")
    Set-NetIPAddress -InterfaceIndex 12 -IPAddress 10.10.10.1 -PrefixLength 24
    
    Exit-PSSession
    Stop-VM -Name ($VMname+"Server")
#Konfiguracja maszyn klienckich
    $VMIpAddress="10.10.10.2"
    for($i=1;$i -le $VMcount;$i++){
        Start-VM -Name ($VMname+$i)
        Enter-PSSession -VMName ($VMname+$i)
        Rename-Computer -NewName ($VMname+$i)
        Set-NetIPAddress -InterfaceIndex 12 -IPAddress ($VMIpAddress+$i) -PrefixLength 24
    
        Exit-PSSession
        Stop-VM -Name ($VMname+$i)
    }
